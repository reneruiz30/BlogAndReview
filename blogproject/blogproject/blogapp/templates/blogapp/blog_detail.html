{% extends 'blogapp/base.html' %}
{% block content %}

<!-- Hero Section -->
<section class="hero-section" style="background-image: url('{% if object.image %}{{ object.image.url }}{% else %}/static/img/hero-default.jpg{% endif %}');">
  <div class="hero-overlay"></div>
  <div class="hero-content" style="display: flex; flex-direction: column; align-items: center; justify-content: center; min-height: 350px;">
    <h1 class="hero-title">{{ object.title }}</h1>
    <p class="hero-subtitle">{{ object.content|truncatechars:150|safe }}</p>
    <a href="#subsections" class="hero-button" style="margin-top: 1.5rem;">BLOGS</a>
  </div>
</section>

<!-- Subsections Section -->
<section id="subsections" class="ideas-section">
  <div class="ideas-header" style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 2rem;">
    <h2 class="ideas-title" style="margin: 0; font-size: 2.1rem; letter-spacing: 0.01em; font-weight: 800; color: #232946;">
      COMPARTE TUS IDEAS
    </h2>
    <a href="{% url 'blogapp:create_subsection' object.pk %}" class="create-subsection-btn">
      <span class="btn-icon">
        <svg width="22" height="22" viewBox="0 0 22 22" fill="none">
          <circle cx="11" cy="11" r="11" fill="#fff" fill-opacity="0.18"/>
          <path d="M11 6V16" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
          <path d="M6 11H16" stroke="#fff" stroke-width="2" stroke-linecap="round"/>
        </svg>
      </span>
      <span class="btn-text">CREAR - POST</span>
    </a>
  </div>
  <div style="display: flex; flex-direction: column; align-items: center; width: 100%;">
    <div class="instituciones-section" style="display: flex; flex-wrap: wrap; justify-content: center; gap: 2rem; width: 100%;">

      {% for subsection in page_obj %}
        <div class="institucion-card" style="position: relative; overflow: visible;">
  <div class="rating-container" style="position:absolute;top:12px;left:12px;z-index:20;">
    <div class="main-rating-star" style="display:flex;align-items:center;gap:0;cursor:pointer;position:relative;">
      <span class="star" style="position:relative;display:inline-block;font-size:2.7rem;color:#FFD700;text-shadow:0 0 16px #232946, 0 0 12px #232946, 0 0 6px #232946, 0 0 2px #232946;border-radius:50%;padding:2px 10px;box-shadow:0 6px 24px 4px rgba(0,0,0,0.55);border:2px solid transparent;background:rgba(30,30,30,0.38);">
        <span class="rating-value" style="position:absolute;left:4px;top:4px;font-size:0.95rem;font-weight:700;color:#fff;text-shadow:0 0 6px #232946, 0 2px 8px #232946, 0 0 2px #232946;pointer-events:none;">{{ subsection.rating|default:"0"|floatformat:1 }}</span>
        &#9733;
      </span>
    </div>
    <!-- Panel de votación compacto -->
    <div class="vote-panel" style="display:none;position:absolute;left:55px;top:50%;transform:translateY(-50%);z-index:999;background:#fff;border-radius:2em;box-shadow:0 2px 8px rgba(0,0,0,0.13);padding:0.3em 1em;min-width:120px;align-items:center;flex-direction:row;gap:6px;">
      <div class="vote-stars" data-subsection="{{ subsection.pk }}" style="display:flex;gap:4px;justify-content:center;">
        {% for i in "12345" %}
          {% with star_num=forloop.counter %}
            <span class="vote-star{% if subsection.rating|default:0 >= star_num %} filled{% endif %}" data-value="{{ star_num }}" style="font-size:1.5rem;color:#FFD700;cursor:pointer;transition:color 0.2s;">&#9733;</span>
          {% endwith %}
        {% endfor %}
      </div>
    </div>
  </div>
  <script>
    (function() {
      var container = document.currentScript.previousElementSibling;
      var mainStar = container.querySelector('.main-rating-star');
      var star = mainStar.querySelector('.star');
      var ratingValue = star.querySelector('.rating-value');
      var votePanel = container.querySelector('.vote-panel');
      var voteStars = container.querySelectorAll('.vote-star');
      var subsectionId = container.querySelector('.vote-stars').getAttribute('data-subsection');

      // Mostrar panel al pasar mouse sobre la estrella o el número
      function showPanel() { votePanel.style.display = 'flex'; }
      function hidePanel() { votePanel.style.display = 'none'; }

      star.addEventListener('mouseenter', showPanel);
      star.addEventListener('mouseleave', function() {
        setTimeout(function() {
          if (!votePanel.matches(':hover')) hidePanel();
        }, 120);
      });
      votePanel.addEventListener('mouseenter', showPanel);
      votePanel.addEventListener('mouseleave', hidePanel);

      // Efecto hover en las estrellas de votación
      voteStars.forEach(function(star, idx) {
        star.addEventListener('mouseenter', function() {
          voteStars.forEach(function(s, i) {
            s.style.color = (i <= idx) ? '#FFD700' : '#ccc';
          });
        });
        star.addEventListener('mouseleave', function() {
          var currentRating = parseFloat(ratingValue.innerText) || 0;
          voteStars.forEach(function(s, i) {
            s.style.color = (i < Math.round(currentRating)) ? '#FFD700' : '#ccc';
          });
        });
        // Votar
        star.addEventListener('click', function() {
          var value = star.getAttribute('data-value');
          fetch('/rate_subsection/' + subsectionId + '/' + value + '/', {
            method: 'POST',
            headers: {
              'X-CSRFToken': window.CSRF_TOKEN || (document.querySelector('[name=csrfmiddlewaretoken]') && document.querySelector('[name=csrfmiddlewaretoken]').value)
            }
          })
          .then(response => response.json())
          .then(data => {
            if (data.success) {
              voteStars.forEach(function(s, i) {
                s.style.color = (i < Math.round(data.new_rating)) ? '#FFD700' : '#ccc';
              });
              ratingValue.innerText = data.new_rating;
            }
          });
        });
      });
      // Inicializar color de estrellas de votación
      var currentRating = parseFloat(ratingValue.innerText) || 0;
      voteStars.forEach(function(s, i) {
        s.style.color = (i < Math.round(currentRating)) ? '#FFD700' : '#ccc';
      });
    })();
  </script>
          {% if user.is_authenticated and user == subsection.owner %}
            <div class="iconos-accion" style="position:absolute;top:8px;right:8px;display:flex;gap:8px;z-index:30;">
  <a href="{% url 'blogapp:edit_subsection' subsection.pk %}" title="Editar" class="icono-editar" style="background:rgba(0,0,0,0.85);border-radius:50%;padding:2.5px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px 1px rgba(0,0,0,0.25);">
    <!-- Icono lápiz outline elegante y un poco más grande -->
    <svg width="19" height="19" viewBox="0 0 24 24" fill="none" stroke="#FFD600" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M12 20h9"/>
      <path d="M16.5 3.5a2.121 2.121 0 0 1 3 3L7 19.5 3 21l1.5-4L16.5 3.5z"/>
    </svg>
  </a>
  <a href="{% url 'blogapp:delete_subsection' subsection.pk %}" title="Borrar" class="icono-borrar" style="background:rgba(0,0,0,0.85);border-radius:50%;padding:2.5px;display:flex;align-items:center;justify-content:center;box-shadow:0 2px 8px 1px rgba(0,0,0,0.25);">
    <!-- Icono papelera outline elegante y un poco más grande -->
    <svg width="15" height="15" viewBox="0 0 24 24" fill="none" stroke="#FF1744" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <polyline points="3 6 5 6 21 6"/>
      <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2"/>
      <line x1="10" y1="11" x2="10" y2="17"/>
      <line x1="14" y1="11" x2="14" y2="17"/>
    </svg>
  </a>
</div>
          {% endif %}
          <div class="institucion-img-wrap">
            {% if subsection.image %}
              <img src="{{ subsection.image.url }}" alt="{{ subsection.name }}" class="institucion-img">
            {% else %}
            {% if subsection.name == "Filosofía y Reflexión" %}
            <img src="https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80" alt="Filosofía y Reflexión">
          {% elif subsection.name == "Cultura Popular" %}
            <img src="https://images.unsplash.com/photo-1503676382389-4809596d5290?auto=format&fit=crop&w=400&q=80" alt="Cultura Popular">
          {% elif subsection.name == "Redes Sociales y Sociedad Digital" %}
            <img src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=400&q=80" alt="Redes Sociales y Sociedad Digital">
          {% elif subsection.name == "Economía y Trabajo" %}
            <img src="https://images.unsplash.com/photo-1461749280684-dccba630e2f6?auto=format&fit=crop&w=400&q=80" alt="Economía y Trabajo">
          {% elif subsection.name == "Juventud y Futuro" %}
            <img src="https://images.unsplash.com/photo-1503676382389-4809596d5290?auto=format&fit=crop&w=400&q=80" alt="Juventud y Futuro">
          {% elif subsection.name == "Derechos Humanos" %}
            <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Derechos Humanos">
          {% elif subsection.name == "Medio Ambiente" %}
            <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Medio Ambiente">
          {% elif subsection.name == "Educación" %}
            <img src="https://images.unsplash.com/photo-1513258496099-48168024aec0?auto=format&fit=crop&w=400&q=80" alt="Educación">
          {% elif subsection.name == "Actualidad y Política" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Actualidad y Política">
          {% elif subsection.name == "Experiencias Locales" %}
            <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Experiencias Locales">
          {% elif subsection.name == "Mochileros y Presupuesto Bajo" %}
            <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Mochileros y Presupuesto Bajo">
          {% elif subsection.name == "Viajes Sostenibles" %}
            <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Viajes Sostenibles">
          {% elif subsection.name == "Cultura y Tradiciones" %}
            <img src="https://images.unsplash.com/photo-1503676382389-4809596d5290?auto=format&fit=crop&w=400&q=80" alt="Cultura y Tradiciones">
          {% elif subsection.name == "Consejos para Viajeros" %}
            <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Consejos para Viajeros">
          {% elif subsection.name == "Viajes Gastronómicos" %}
            <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=400&q=80" alt="Viajes Gastronómicos">
          {% elif subsection.name == "Turismo de Aventura" %}
            <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Turismo de Aventura">
          {% elif subsection.name == "Destinos Populares" %}
            <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Destinos Populares">
          {% elif subsection.name == "Minimalismo y Productividad" %}
            <img src="https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80" alt="Minimalismo y Productividad">
          {% elif subsection.name == "Hogar y Decoración" %}
            <img src="https://images.unsplash.com/photo-1512918728675-ed5a9ecdebfd?auto=format&fit=crop&w=400&q=80" alt="Hogar y Decoración">
          {% elif subsection.name == "Psicología y Emociones" %}
            <img src="https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80" alt="Psicología y Emociones">
          {% elif subsection.name == "Fitness" %}
            <img src="https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=400&q=80" alt="Fitness">
          {% elif subsection.name == "Vida Saludable" %}
            <img src="https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80" alt="Vida Saludable">
          {% elif subsection.name == "Moda y Tendencias" %}
            <img src="https://images.unsplash.com/photo-1512918728675-ed5a9ecdebfd?auto=format&fit=crop&w=400&q=80" alt="Moda y Tendencias">
          {% elif subsection.name == "Restaurantes y Críticas" %}
            <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=400&q=80" alt="Restaurantes y Críticas">
          {% elif subsection.name == "Tips de Nutrición" %}
            <img src="https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=400&q=80" alt="Tips de Nutrición">
          {% elif subsection.name == "Cocina Internacional" %}
            <img src="https://images.unsplash.com/photo-1504674900247-0877df9cc836?auto=format&fit=crop&w=400&q=80" alt="Cocina Internacional">
          {% elif subsection.name == "Recetas Caseras" %}
            <img src="https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=400&q=80" alt="Recetas Caseras">
          {% elif subsection.name == "Innovaciones Médicas" %}
            <img src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=400&q=80" alt="Innovaciones Médicas">
          {% elif subsection.name == "Curiosidades Científicas" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Curiosidades Científicas">
          {% elif subsection.name == "Robótica" %}
            <img src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=400&q=80" alt="Robótica">
          {% elif subsection.name == "Ciberseguridad" %}
            <img src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=400&q=80" alt="Ciberseguridad">
          {% elif subsection.name == "Medio Ambiente y Tecnología Verde" %}
            <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Medio Ambiente y Tecnología Verde">
          {% elif subsection.name == "Ciencia Espacial" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Ciencia Espacial">
          {% elif subsection.name == "Tecnología de Consumo (smartphones, wearables)" %}
            <img src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=400&q=80" alt="Tecnología de Consumo">
          {% elif subsection.name == "Aplicaciones Móviles" %}
            <img src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=400&q=80" alt="Aplicaciones Móviles">
          {% elif subsection.name == "Inteligencia Artificial" %}
            <img src="https://images.unsplash.com/photo-1519389950473-47ba0277781c?auto=format&fit=crop&w=400&q=80" alt="Inteligencia Artificial">
          {% elif subsection.name == "Premios y Festivales" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Premios y Festivales">
          {% elif subsection.name == "Noticias de la Industria" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Noticias de la Industria">
          {% elif subsection.name == "Cine Latinoamericano" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Cine Latinoamericano">
          {% elif subsection.name == "Streaming" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Streaming">
          {% elif subsection.name == "Documentales" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Documentales">
          {% elif subsection.name == "Directores y Cineastas" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Directores y Cineastas">
          {% elif subsection.name == "Cine Clásico" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Cine Clásico">
          {% elif subsection.name == "Series Recomendadas" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Series Recomendadas">
          {% elif subsection.name == "Críticas de Películas" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Críticas de Películas">
          {% elif subsection.name == "Estrenos" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Estrenos">
          {% elif subsection.name == "Críticas de Álbumes" %}
            <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=400&q=80" alt="Críticas de Álbumes">
          {% elif subsection.name == "Clásica" %}
            <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=400&q=80" alt="Clásica">
          {% elif subsection.name == "Jazz y Blues" %}
            <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=400&q=80" alt="Jazz y Blues">
          {% elif subsection.name == "Electrónica" %}
            <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=400&q=80" alt="Electrónica">
          {% elif subsection.name == "Reggaetón, Trap" %}
            <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=400&q=80" alt="Reggaetón, Trap">
          {% elif subsection.name == "Pop" %}
            <img src="https://images.unsplash.com/photo-1511671782779-c97d3d27a1d4?auto=format&fit=crop&w=400&q=80" alt="Pop">
          {% elif subsection.name == "Rock" %}
            <img src="https://images.unsplash.com/photo-1465101178521-c1a9136a3b99?auto=format&fit=crop&w=400&q=80" alt="Rock">
          {% elif subsection.name == "Ciclismo" %}
            <img src="https://images.unsplash.com/photo-1505843279827-c7d8e5b89847?auto=format&fit=crop&w=400&q=80" alt="Ciclismo">
          {% elif subsection.name == "Artes Marciales Mixtas" %}
            <img src="https://images.unsplash.com/photo-1519864600265-abb23847ef2c?auto=format&fit=crop&w=400&q=80" alt="Artes Marciales Mixtas">
          {% elif subsection.name == "Deportes Olímpicos" %}
            <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="Deportes Olímpicos">
          {% elif subsection.name == "Fórmula 1" %}
            <img src="https://images.unsplash.com/photo-1503736334956-4c8f8e92946d?auto=format&fit=crop&w=400&q=80" alt="Fórmula 1">
          {% elif subsection.name == "Tenis" %}
            <img src="https://images.unsplash.com/photo-1464983953574-0892a716854b?auto=format&fit=crop&w=400&q=80" alt="Tenis">
          {% elif subsection.name == "Béisbol" %}
            <img src="https://images.unsplash.com/photo-1503342217505-b0a15ec3261c?auto=format&fit=crop&w=400&q=80" alt="Béisbol">
          {% elif subsection.name == "Baloncesto" %}
            <img src="https://images.unsplash.com/photo-1517649763962-0c623066013b?auto=format&fit=crop&w=400&q=80" alt="Baloncesto">
          {% elif subsection.name == "Fútbol Nacional" %}
            <img src="https://images.unsplash.com/photo-1517927033932-b3d18e61fb3a?auto=format&fit=crop&w=400&q=80" alt="Fútbol Nacional">
          {% elif subsection.name == "Fútbol Internacional" %}
            <img src="https://images.unsplash.com/photo-1506744038136-46273834b3fb?auto=format&fit=crop&w=400&q=80" alt="Fútbol Internacional">
          {% else %}
            <img src="https://images.unsplash.com/photo-1465101046530-73398c7f28ca?auto=format&fit=crop&w=400&q=80" alt="{{ subsection.name }}">
          {% endif %}
        {% endif %}
            <svg class="wave-decoration" viewBox="0 0 340 48" fill="none" xmlns="http://www.w3.org/2000/svg">
              <path fill="#0091d0" fill-opacity="0.15" d="M0,24 Q85,48 170,24 T340,24 V48 H0 Z"/>
            </svg>
          </div>
          <h3>{{ subsection.name }}</h3>
          <p><strong>
            {% if subsection.description %}
              {{ subsection.description }}
            {% else %}
            <!-- Optionally, add a default description here -->
            {% if subsection.name == "Filosofía y Reflexión" %}
            Comparte tus pensamientos filosóficos y reflexiones profundas. ¡Tu visión puede inspirar a otros a ver el mundo de otra manera!
          {% elif subsection.name == "Cultura Popular" %}
            Opina sobre las tendencias, música, cine y todo lo que mueve la cultura pop. ¡Haz que tu voz se escuche!
          {% elif subsection.name == "Redes Sociales y Sociedad Digital" %}
            Analiza el impacto de la tecnología y las redes sociales en nuestra vida diaria. ¡Comparte tus experiencias digitales!
          {% elif subsection.name == "Economía y Trabajo" %}
            Aporta ideas sobre el mundo laboral, emprendimiento y economía. ¡Tus consejos pueden ayudar a otros a crecer profesionalmente!
          {% elif subsection.name == "Juventud y Futuro" %}
            Inspira a la próxima generación compartiendo tus sueños, retos y perspectivas sobre el futuro.
          {% elif subsection.name == "Derechos Humanos" %}
            Defiende la justicia y la igualdad. ¡Tu opinión puede marcar la diferencia en la lucha por los derechos humanos!
          {% elif subsection.name == "Medio Ambiente" %}
            Motiva a cuidar el planeta compartiendo acciones ecológicas, ideas verdes y soluciones sostenibles.
          {% elif subsection.name == "Educación" %}
            Comparte recursos, consejos y experiencias educativas para transformar vidas y fomentar el aprendizaje.
          {% elif subsection.name == "Actualidad y Política" %}
            Debate sobre los temas más relevantes del momento y expresa tu visión sobre la política actual.
          {% elif subsection.name == "Experiencias Locales" %}
            Relata vivencias únicas de tu ciudad o región. ¡Haz que otros descubran lo especial de tu entorno!
          {% elif subsection.name == "Mochileros y Presupuesto Bajo" %}
            Da tips y comparte aventuras para viajar con poco dinero. ¡Demuestra que explorar el mundo es posible para todos!
          {% elif subsection.name == "Viajes Sostenibles" %}
            Promueve el turismo responsable y comparte formas de viajar cuidando el medio ambiente.
          {% elif subsection.name == "Cultura y Tradiciones" %}
            Resalta costumbres, festividades y tradiciones que enriquecen nuestra identidad.
          {% elif subsection.name == "Consejos para Viajeros" %}
            Ayuda a otros a planear sus viajes con recomendaciones prácticas y experiencias personales.
          {% elif subsection.name == "Viajes Gastronómicos" %}
            Descubre y comparte sabores del mundo. ¡Haz que otros se animen a probar nuevas delicias!
          {% elif subsection.name == "Turismo de Aventura" %}
            Motiva a vivir experiencias extremas y a descubrir destinos llenos de adrenalina.
          {% elif subsection.name == "Destinos Populares" %}
            Recomienda lugares imperdibles y comparte lo mejor de los destinos más visitados.
          {% elif subsection.name == "Minimalismo y Productividad" %}
            Inspira a simplificar la vida y a ser más productivo con hábitos y consejos prácticos.
          {% elif subsection.name == "Hogar y Decoración" %}
            Comparte ideas para crear espacios acogedores y llenos de estilo en casa.
          {% elif subsection.name == "Psicología y Emociones" %}
            Ayuda a otros a comprender y gestionar sus emociones compartiendo reflexiones y recursos psicológicos.
          {% elif subsection.name == "Fitness" %}
            Motiva a llevar una vida activa y saludable con rutinas, retos y consejos de ejercicio.
          {% elif subsection.name == "Vida Saludable" %}
            Promueve hábitos que mejoran el bienestar físico y mental. ¡Tu experiencia puede inspirar cambios positivos!
          {% elif subsection.name == "Moda y Tendencias" %}
            Expresa tu estilo y comparte lo último en moda para inspirar a otros a reinventarse.
          {% elif subsection.name == "Restaurantes y Críticas" %}
            Recomienda tus lugares favoritos y ayuda a otros a descubrir nuevas experiencias gastronómicas.
          {% elif subsection.name == "Tips de Nutrición" %}
            Comparte consejos prácticos para una alimentación equilibrada y saludable.
          {% elif subsection.name == "Cocina Internacional" %}
            Explora y comparte recetas de diferentes culturas para enriquecer el paladar de todos.
          {% elif subsection.name == "Recetas Caseras" %}
            Inspira a cocinar en casa con recetas fáciles, deliciosas y llenas de sabor.
          {% elif subsection.name == "Innovaciones Médicas" %}
            Difunde avances y descubrimientos que están revolucionando la salud y la medicina.
          {% elif subsection.name == "Curiosidades Científicas" %}
            Sorprende a todos con datos y descubrimientos fascinantes del mundo de la ciencia.
          {% elif subsection.name == "Robótica" %}
            Comparte avances, proyectos y curiosidades sobre el mundo de la robótica.
          {% elif subsection.name == "Ciberseguridad" %}
            Ayuda a proteger la información digital compartiendo consejos y novedades en seguridad informática.
          {% elif subsection.name == "Medio Ambiente y Tecnología Verde" %}
            Promueve la innovación sostenible y comparte soluciones tecnológicas para cuidar el planeta.
          {% elif subsection.name == "Ciencia Espacial" %}
            Inspira a explorar el universo compartiendo noticias y curiosidades sobre el espacio.
          {% elif subsection.name == "Tecnología de Consumo (smartphones, wearables)" %}
            Recomienda gadgets y comparte experiencias con la tecnología que usamos a diario.
          {% elif subsection.name == "Aplicaciones Móviles" %}
            Descubre y recomienda apps útiles para facilitar la vida cotidiana.
          {% elif subsection.name == "Inteligencia Artificial" %}
            Explica y debate sobre el impacto de la IA en la sociedad y el futuro.
          {% elif subsection.name == "Premios y Festivales" %}
            Comparte experiencias y opiniones sobre los eventos más destacados del mundo cultural.
          {% elif subsection.name == "Noticias de la Industria" %}
            Mantén a todos informados sobre las novedades y tendencias en diferentes sectores.
          {% elif subsection.name == "Cine Latinoamericano" %}
            Da visibilidad a películas y creadores de nuestra región. ¡Apoya el talento local!
          {% elif subsection.name == "Streaming" %}
            Recomienda series, películas y plataformas para disfrutar del mejor contenido online.
          {% elif subsection.name == "Documentales" %}
            Motiva a descubrir historias reales y educativas a través de documentales impactantes.
          {% elif subsection.name == "Directores y Cineastas" %}
            Analiza el trabajo de grandes creadores y comparte tus favoritos.
          {% elif subsection.name == "Cine Clásico" %}
            Rinde homenaje a las obras maestras del cine que han marcado generaciones.
          {% elif subsection.name == "Series Recomendadas" %}
            Ayuda a otros a encontrar su próxima serie favorita con tus recomendaciones.
          {% elif subsection.name == "Críticas de Películas" %}
            Comparte tus opiniones y análisis sobre los últimos estrenos y clásicos del cine.
          {% elif subsection.name == "Estrenos" %}
            Mantén a todos al día con las novedades y lanzamientos más esperados.
          {% elif subsection.name == "Críticas de Álbumes" %}
            Expresa tu opinión sobre los nuevos lanzamientos musicales y descubre nuevos sonidos.
          {% elif subsection.name == "Clásica" %}
            Comparte la belleza y profundidad de la música clásica con otros amantes del género.
          {% elif subsection.name == "Jazz y Blues" %}
            Inspira a descubrir la magia del jazz y el blues con recomendaciones y anécdotas.
          {% elif subsection.name == "Electrónica" %}
            Comparte lo último en música electrónica y tendencias del género.
          {% elif subsection.name == "Reggaetón, Trap" %}
            Debate sobre los ritmos urbanos que dominan las listas y comparte tus favoritos.
          {% elif subsection.name == "Pop" %}
            Recomienda éxitos y artistas pop que están marcando tendencia.
          {% elif subsection.name == "Rock" %}
            Comparte la energía y pasión del rock con historias, discos y bandas legendarias.
          {% elif subsection.name == "Ciclismo" %}
            Motiva a pedalear compartiendo rutas, consejos y experiencias sobre dos ruedas.
          {% elif subsection.name == "Artes Marciales Mixtas" %}
            Analiza combates, técnicas y comparte tu pasión por las MMA.
          {% elif subsection.name == "Deportes Olímpicos" %}
            Celebra el espíritu olímpico compartiendo historias y logros deportivos.
          {% elif subsection.name == "Fórmula 1" %}
            Vive la emoción de la velocidad comentando carreras, pilotos y escuderías.
          {% elif subsection.name == "Tenis" %}
            Comparte estrategias, partidos memorables y tu pasión por el tenis.
          {% elif subsection.name == "Béisbol" %}
            Relata jugadas, equipos y momentos históricos del béisbol.
          {% elif subsection.name == "Baloncesto" %}
            Motiva a encestar compartiendo anécdotas y consejos sobre baloncesto.
          {% elif subsection.name == "Fútbol Nacional" %}
            Apoya a tu equipo y comparte la pasión por el fútbol de tu país.
          {% elif subsection.name == "Fútbol Internacional" %}
            Debate sobre las grandes ligas y estrellas del fútbol mundial.
          {% elif subsection.name == "Fútbol Nacional" %}
            Apoya a tu equipo y comparte la pasión por el fútbol de tu país.
          {% elif subsection.name == "Baloncesto" %}
            Motiva a encestar compartiendo anécdotas y consejos sobre baloncesto.
          {% elif subsection.name == "Béisbol" %}
            Relata jugadas, equipos y momentos históricos del béisbol.
          {% elif subsection.name == "Tenis" %}
            Comparte estrategias, partidos memorables y tu pasión por el tenis.
          {% elif subsection.name == "Fórmula 1" %}
            Vive la emoción de la velocidad comentando carreras, pilotos y escuderías.
          {% else %}
            ¡Comienza a comentar y comparte tus ideas, experiencias y opiniones sobre {{ subsection.name|lower }}!
            {% endif %}
            {% endif %}
          </strong></p>
          <a href="{% url 'blogapp:subsection_detail' subsection.pk %}" class="institucion-btn">
            Comienza a Comentar
          </a>
          {% if user.is_authenticated and user == subsection.owner %}
          {% endif %}
        </div>
      {% endfor %}
    </div>
  </div>
  
  <!-- Paginado fuera del bucle -->
  <div class="pagination" style="margin-top: 2rem; text-align: center;">
    <style>
      .pagination {
        display: flex;
        justify-content: center;
        align-items: center;
        gap: 2rem;
        margin: 2.5rem 0 1.5rem 0;
        font-family: 'Segoe UI', 'Roboto', Arial, sans-serif;
      }
      .pagination a {
        background: linear-gradient(90deg, #0ea5e9 40%, #2563eb 100%);
        color: #fff;
        border: none;
        border-radius: 8px;
        padding: 0.5rem 1.3rem;
        font-size: 1rem;
        font-weight: 600;
        text-decoration: none;
        box-shadow: 0 2px 8px rgba(30,58,138,0.07);
        transition: background 0.2s, color 0.2s, box-shadow 0.2s;
        cursor: pointer;
        outline: none;
        border: 1.5px solid #2563eb;
        display: inline-block;
      }
      .pagination a:hover {
        background: linear-gradient(90deg, #2563eb 40%, #0ea5e9 100%);
        color: #fff;
        box-shadow: 0 4px 16px #0ea5e955;
        border-color: #0ea5e9;
      }
      .pagination .page-info {
        color: #232946;
        font-size: 1.08rem;
        font-weight: 500;
        background: #f1f5fa;
        border-radius: 6px;
        padding: 0.4rem 1rem;
        box-shadow: 0 1px 4px #2563eb11;
        display: inline-block;
      }
    </style>
    {% if page_obj.has_previous %}
      <a href="?page={{ page_obj.previous_page_number }}">Anterior</a>
    {% endif %}
    <span class="page-info">Página {{ page_obj.number }} de {{ page_obj.paginator.num_pages }}</span>
    {% if page_obj.has_next %}
      <a href="?page={{ page_obj.next_page_number }}">Siguiente</a>
    {% endif %}
  </div>
</section>

<style>
  
  .create-subsection-btn {
    display: flex;
    align-items: center;
    gap: 0.7em;
    background: linear-gradient(90deg, #ff6a00 0%, #ee0979 100%);
    color: #fff;
    padding: 13px 34px;
    border-radius: 40px;
    font-weight: 700;
    text-decoration: none;
    font-size: 1.08rem;
    box-shadow: 0 4px 24px rgba(238,9,121,0.13), 0 1.5px 6px rgba(255,106,0,0.10);
    transition: background 0.2s, color 0.2s, box-shadow 0.2s, transform 0.15s;
    border: none;
    letter-spacing: 0.01em;
    position: relative;
    overflow: hidden;
    cursor: pointer;
    z-index: 1;
    outline: none;
  }
  .create-subsection-btn .btn-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    background: rgba(255,255,255,0.13);
    border-radius: 50%;
    width: 2.2em;
    height: 2.2em;
    box-shadow: 0 2px 8px rgba(238,9,121,0.10);
    transition: background 0.2s;
  }
  .create-subsection-btn:hover .btn-icon {
    background: rgba(255,255,255,0.22);
  }
  .create-subsection-btn::before {
    content: "";
    position: absolute;
    left: 50%;
    top: 50%;
    width: 0;
    height: 0;
    background: radial-gradient(circle, #fff 0%, transparent 70%);
    opacity: 0.18;
    border-radius: 50%;
    transform: translate(-50%, -50%);
    transition: width 0.4s, height 0.4s;
    z-index: 0;
  }
  .create-subsection-btn:hover {
    background: linear-gradient(90deg, #ee0979 0%, #ff6a00 100%);
    color: #fff;
    box-shadow: 0 8px 32px rgba(238,9,121,0.18);
    transform: translateY(-2px) scale(1.045);
  }
  .create-subsection-btn:hover::before {
    width: 250%;
    height: 250%;
  }
  .create-subsection-btn .btn-text {
    position: relative;
    z-index: 1;
    font-size: 1.08rem;
    font-weight: 700;
    letter-spacing: 0.01em;
  }
  @media (max-width: 700px) {
    .ideas-header {
      flex-direction: column;
      align-items: stretch;
      gap: 1rem;
      text-align: left;
    }
    .create-subsection-btn {
      align-self: flex-end;
      width: 100%;
      justify-content: center;
      text-align: center;
      margin-top: 0.5rem;
    }
  } 
  
    /* Duplicated and likely unintended style block removed */
  
    @media (max-width: 900px) {
      .cards-style {
        justify-content: center;
      }
  
      .book-card {
        width: 45vw;
        min-width: 180px;
        max-width: 300px;
      }
    }
  
    @media (max-width: 600px) {
      .cards-style {
        flex-direction: column;
        align-items: center;
      }
  
      .book-card {
        width: 90vw;
        min-width: 160px;
        max-width: 98vw;
      }
    }
  
    /* Mejoras visuales para las tarjetas */
    .improved-card {
      box-shadow: 0 8px 32px rgba(30, 58, 138, 0.15);
      border: none;
      transition: transform 0.25s, box-shadow 0.25s;
      overflow: hidden;
      position: relative;
    }
  
    .improved-card:hover {
      transform: translateY(-8px) scale(1.04);
      box-shadow: 0 16px 40px rgba(30, 58, 138, 0.25);
    }
  
    .improved-image {
      width: 120px;
      height: 120px;
      margin: 0 auto 1rem auto;
      border-radius: 50%;
      overflow: hidden;
      border: 4px solid #3b82f6;
      box-shadow: 0 4px 16px rgba(59, 130, 246, 0.12);
      background: #f3f4f6;
      display: flex;
      align-items: center;
      justify-content: center;
    }
  
    .improved-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      transition: transform 0.3s;
    }
  
    .improved-card:hover .improved-image img {
      transform: scale(1.08) rotate(-2deg);
    }
  
    /* Hero section */
    .hero-section {
      position: relative;
      left: 50%;
      right: 50%;
      margin-left: -50vw;
      margin-right: -50vw;
      width: 100vw;
      min-width: 100vw;
      max-width: 100vw;
      min-height: 100vh;
      background-size: cover;
      background-position: center;
      display: flex;
      align-items: center;
      justify-content: center;
      margin-top: 0;
      margin-bottom: 0;
      padding: 0;
      box-sizing: border-box;
    }
  
    .hero-overlay {
      position: absolute;
      inset: 0;
      background: rgba(0, 0, 0, 0.5);
    }
  
    .hero-content {
      position: relative;
      text-align: center;
      color: white;
      z-index: 10;
      padding: 20px;
    }
  
    .hero-title {
      font-size: 3rem;
      font-weight: bold;
      margin-bottom: 1rem;
    }
  
    .hero-subtitle {
      font-size: 1.2rem;
      margin-bottom: 2rem;
    }
  
    .hero-button {
      padding: 0.75rem 1.5rem;
      background-color: white;
      color: black;
      border-radius: 9999px;
      text-decoration: none;
      font-weight: bold;
      transition: 0.3s ease;
    }
  
    .hero-button:hover {
      background-color: #3b82f6;
      color: white;
    }
  
    /* Ideas section */
    .ideas-section {
      background: #f9fafb;
      padding: 4rem 2rem;
      text-align: center;
    }
  
    .ideas-title {
      font-size: 2.5rem;
      font-weight: bold;
      margin-bottom: 2rem;
    }
  
    .ideas-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 2rem;
      max-width: 1200px;
      margin: 0 auto;
    }
  
    .idea-card {
      background: white;
      padding: 2rem;
      border-radius: 1rem;
      box-shadow: 0 4px 14px rgba(0, 0, 0, 0.1);
      transition: transform 0.3s ease;
    }
  
    .idea-card:hover {
      transform: scale(1.05);
    }
  
    .idea-image {
      width: 120px;
      height: 120px;
      margin: 0 auto;
      overflow: hidden;
      border-radius: 50%;
      border: 4px solid #3b82f6;
    }
  
    .idea-image img {
      width: 100%;
      height: 100%;
      object-fit: cover;
    }
  
    .idea-name {
      font-size: 1.25rem;
      font-weight: 600;
      margin-top: 1rem;
    }
  
    .idea-description {
      font-size: 0.9rem;
      color: #6b7280;
      margin: 0.5rem 0 1rem;
    }
  
    .idea-button {
      display: inline-block;
      padding: 0.5rem 1.25rem;
      background-color: #3b82f6;
      color: white;
      border-radius: 9999px;
      text-decoration: none;
      font-weight: 500;
    }
  
    .idea-button:hover {
      background-color: #2563eb;
    }
  
    .no-subsections {
      color: #888;
      font-size: 1.1rem;
    }
  
    /* Responsive */
    @media (max-width: 640px) {
      .hero-title {
        font-size: 2rem;
      }
  
      .hero-subtitle {
        font-size: 1rem;
      }
    }

    .instituciones-section {
      display: grid;
      grid-template-columns: repeat(3, 1fr);
      gap: 32px;
      justify-items: center;
      padding: 40px 0 60px 0;
      background: transparent;
    }
    @media (max-width: 992px) {
      .instituciones-section {
        grid-template-columns: repeat(2, 1fr);
        gap: 18px;
        padding: 30px 0 40px 0;
      }
    }
    @media (max-width: 600px) {
      .instituciones-section {
        grid-template-columns: 1fr;
        gap: 16px;
        padding: 18px 0 24px 0;
      }
    }
    .pagination {
      display: flex;
      justify-content: center;
      align-items: center;
      gap: 1.5rem;
      margin-top: 2rem;
    }
    .page-btn {
      background: #0a3d6b;
      color: #fff;
      padding: 8px 22px;
      border-radius: 8px;
      text-decoration: none;
      font-weight: 600;
      transition: background 0.2s;
    }
    .page-btn:hover {
      background: #0091d0;
    }
    .current-page {
      font-weight: 700;
      color: #0091d0;
    }
    .institucion-card {
      background: linear-gradient(135deg, #eaf6fb 60%, #cbe7fa 100%);
      border-radius: 18px;
      box-shadow: 0 8px 32px rgba(44, 62, 80, 0.13);
      transition: transform 0.35s cubic-bezier(.4,2,.6,1), box-shadow 0.35s cubic-bezier(.4,2,.6,1), border-top 0.35s cubic-bezier(.4,2,.6,1);
      width: 340px;
      min-height: 420px;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 0 0 28px 0;
      position: relative;
      overflow: hidden;
      border: 2.5px solid #3fa1e0;
      margin-bottom: 10px;
      
    }
    .institucion-card:hover {
      transform: translateY(-12px) scale(1.035);
      box-shadow: 0 20px 48px rgba(44, 62, 80, 0.18), 0 0 0 4px var(--accent-color, #3fa1e0);
      border-top: 4px solid var(--accent-color, #3fa1e0);
      z-index: 2;
    }
    .institucion-card:active {
      transform: scale(0.98);
      box-shadow: 0 4px 16px rgba(44, 62, 80, 0.10);
    }
    .institucion-card .institucion-img-wrap {
      width: 100%;
      height: 150px;
      position: relative;
      overflow: hidden;
    }
    .institucion-card .institucion-img {
      width: 100%;
      height: 100%;
      object-fit: cover;
      display: block;
      z-index: 1;
    }
    .institucion-card .wave-decoration {
      position: absolute;
      left: 0;
      bottom: 0;
      width: 100%;
      height: 48px;
      pointer-events: none;
      z-index: 2;
    }
    .institucion-card h3 {
      color: #0091d0;
      font-size: 1.25rem;
      font-weight: 700;
      margin: 24px 0 8px 0;
      text-align: center;
      font-family: var(--font-secondary);
    }
    .institucion-card p {
      color: #2c3e50;
      font-size: 1.05rem;
      margin: 0 24px 18px 24px;
      text-align: center;
      font-weight: 500;
    }
    .institucion-card ul {
      list-style: none;
      padding: 0 32px 0 32px;
      margin: 0 0 18px 0;
    }
    .institucion-card ul li {
      display: flex;
      align-items: flex-start;
      gap: 8px;
      color: #2c3e50;
      font-size: 0.98rem;
      margin-bottom: 8px;
    }
    .institucion-card ul li i {
      color: #0091d0;
      font-size: 1.1rem;
      margin-top: 2px;
    }
    .institucion-card .institucion-btn {
      margin-top: auto;
      background: #0a3d6b;
      color: #fff;
      font-weight: 600;
      font-size: 1.08rem;
      border: none;
      border-radius: 10px;
      padding: 12px 32px;
      box-shadow: 0 4px 16px rgba(44,62,80,0.10);
      transition: background 0.2s, transform 0.2s;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 8px;
    }
    .institucion-card .institucion-btn:hover {
      background: #0091d0;
      transform: translateY(-2px) scale(1.03);
    }
    @media (max-width: 992px) {
      .instituciones-section {
        gap: 18px;
        padding: 30px 0 40px 0;
      }
      .institucion-card {
        width: 90vw;
        max-width: 340px;
        min-height: 380px;
        padding: 0 0 18px 0;
      }
    }
    @media (max-width: 600px) {
      .instituciones-section {
        flex-direction: column;
        align-items: center;
        gap: 16px;
        padding: 18px 0 24px 0;
      }
      .institucion-card {
        width: 98vw;
        max-width: 98vw;
        min-height: 260px;
        padding: 0 0 12px 0;
      }
    }
    /* === TÍTULO DE INSTITUCIONES ELEGANTE === */
    .instituciones-title {
      font-family: 'Montserrat', 'Poppins', Arial, sans-serif;
      font-size: 2.2rem;
      color: #0a3d6b;
      font-weight: 700;
      letter-spacing: 1px;
      text-align: center;
      margin-top: 48px;
      margin-bottom: 24px;
      position: relative;
      z-index: 2;
      transition: color 0.3s;
      cursor: pointer;
    }
    .instituciones-title::after {
      content: "";
      display: block;
      width: 80px;
      height: 4px;
      background: linear-gradient(90deg, #0091d0 0%, #0a3d6b 100%);
      margin: 16px auto 0 auto;
      border-radius: 2px;
      transition: width 0.3s;
    }
    .instituciones-title:hover {
      color: #0091d0;
    }
    .instituciones-title:hover::after {
      width: 120px;
    }

    @media (max-width: 992px) {
      .instituciones-section {
        gap: 18px;
        padding: 30px 0 40px 0;
      }
      .institucion-card {
        width: 90vw;
        max-width: 340px;
        min-height: 380px;
        padding: 0 0 18px 0;
      }
    }
    @media (max-width: 600px) {
      .instituciones-section {
        flex-direction: column;
        align-items: center;
        gap: 16px;
        padding: 18px 0 24px 0;
      }
      .institucion-card {
        width: 98vw;
        max-width: 98vw;
        min-height: 260px;
        padding: 0 0 12px 0;
      }
    }
    /* === TÍTULO DE INSTITUCIONES ELEGANTE === */
    .instituciones-title {
      font-family: 'Montserrat', 'Poppins', Arial, sans-serif;
      font-size: 2.2rem;
      color: #0a3d6b;
      font-weight: 700;
      letter-spacing: 1px;
      text-align: center;
      margin-top: 48px;
      margin-bottom: 24px;
      position: relative;
      z-index: 2;
      transition: color 0.3s;
      cursor: pointer;
    }
    .instituciones-title::after {
      content: "";
      display: block;
      width: 80px;
      height: 4px;
      background: linear-gradient(90deg, #0091d0 0%, #0a3d6b 100%);
      margin: 16px auto 0 auto;
      border-radius: 2px;
      transition: width 0.3s;
    }
    .instituciones-title:hover {
      color: #0091d0;
    }
    .instituciones-title:hover::after {
      width: 120px;
    }

    .iconos-accion {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 0.5em;
      z-index: 100;
    }
    .iconos-accion a {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      transition: transform 0.15s, box-shadow 0.15s;
      border-radius: 50%;
    }
    .iconos-accion a:hover {
      transform: scale(1.2) rotate(-10deg);
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
    }
    .iconos-accion svg {
      pointer-events: none;
    }

    .iconos-accion a {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      transition: transform 0.2s cubic-bezier(0.4, 0.2, 0.2, 1), box-shadow 0.15s;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .iconos-accion a:hover {
      transform: scale(1.3) rotate(-10deg);
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      background: rgba(0,0,0,0.04);
    }


    .iconos-accion {
      position: absolute;
      top: 10px;
      right: 10px;
      display: flex;
      gap: 0.5em;
      z-index: 100;
    }
    .institucion-card {
      transition: box-shadow 0.2s, transform 0.2s;
    }
    .institucion-card.hover-effect {
      box-shadow: 0 8px 24px rgba(0,0,0,0.12);
      transform: translateY(-4px) scale(1.03);
    }
    .iconos-accion a {
      background: none;
      border: none;
      padding: 0;
      cursor: pointer;
      transition: transform 0.2s cubic-bezier(0.4, 0.2, 0.2, 1), box-shadow 0.15s;
      border-radius: 50%;
      display: flex;
      align-items: center;
      justify-content: center;
    }
    .iconos-accion a:hover {
      transform: scale(1.3) rotate(-10deg);
      box-shadow: 0 2px 8px rgba(0,0,0,0.15);
      background: rgba(0,0,0,0.04);
    }


    </style>
    <script>
    document.querySelectorAll('.institucion-card').forEach(function(card) {
      let iconos = card.querySelector('.iconos-accion');
      let isOverIcon = false;
    
      card.addEventListener('mouseenter', function() {
        if (!isOverIcon) card.classList.add('hover-effect');
      });
      card.addEventListener('mouseleave', function() {
        card.classList.remove('hover-effect');
      });
    
      if (iconos) {
        iconos.addEventListener('mouseenter', function(e) {
          isOverIcon = true;
          card.classList.remove('hover-effect');
        });
        iconos.addEventListener('mouseleave', function(e) {
          isOverIcon = false;
        });
      }
    });
    </script>
    

  </style>

<!-- SweetAlert2 CDN -->
<script src="https://cdn.jsdelivr.net/npm/sweetalert2@11"></script>
<script>
document.querySelectorAll('.icono-borrar').forEach(function(btn) {
  btn.addEventListener('click', function(e) {
    e.preventDefault();
    const url = btn.getAttribute('href');
    const card = btn.closest('.institucion-card');
    Swal.fire({
      title: '¿Estás seguro?',
      text: "Esta acción eliminará la subsección de forma permanente.",
      icon: 'warning',
      showCancelButton: true,
      confirmButtonColor: '#3085d6',
      cancelButtonColor: '#d33',
      confirmButtonText: 'Sí, eliminar',
      cancelButtonText: 'Cancelar'
    }).then((result) => {
      if (result.isConfirmed) {
        fetch(url, {
          method: 'POST',
          headers: {
            'X-Requested-With': 'XMLHttpRequest',
            'X-CSRFToken': getCookie('csrftoken')
          }
        })
        .then(response => {
          if (response.ok) {
            Swal.fire('¡Eliminado!', 'La subsección ha sido eliminada.', 'success');
            if (card) card.remove();
          } else {
            Swal.fire('Error', 'No se pudo eliminar la subsección.', 'error');
          }
        })
        .catch(() => {
          Swal.fire('Error', 'No se pudo eliminar la subsección.', 'error');
        });
      }
    });
  });
});
// Función para obtener el CSRF token de las cookies
function getCookie(name) {
  let cookieValue = null;
  if (document.cookie && document.cookie !== '') {
    const cookies = document.cookie.split(';');
    for (let i = 0; i < cookies.length; i++) {
      const cookie = cookies[i].trim();
      if (cookie.substring(0, name.length + 1) === (name + '=')) {
        cookieValue = decodeURIComponent(cookie.substring(name.length + 1));
        break;
      }
    }
  }
  return cookieValue;
}
</script>

<!-- JS scroll suave -->
<script>
document.querySelectorAll('a[href^="#"]').forEach(anchor => {
  anchor.addEventListener("click", function(e) {
    e.preventDefault();
    document.querySelector(this.getAttribute("href")).scrollIntoView({
      behavior: "smooth"
    });
  });
});
</script>
<script>
document.addEventListener('click', function(e) {
  if(e.target.classList.contains('page-btn')) {
    e.preventDefault();
    let page = e.target.getAttribute('data-page');
    let url = window.location.pathname + '?page=' + page;
    fetch(url, {headers: {'X-Requested-With': 'XMLHttpRequest'}})
      .then(response => response.text())
      .then(html => {
        document.getElementById('subsections-container').innerHTML = html;
        window.scrollTo({top: document.getElementById('subsections-container').offsetTop, behavior: 'smooth'});
      });
  }
});
</script>

{% endblock %}

